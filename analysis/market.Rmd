---
title: "CPU Market Analysis"
output: 
  github_document:
    df_print: kable
---

## Set-Up

Load the necessary libraries:
```{r}
pacman::p_load(pacman, rio, dplyr, ggplot2, jsonlite)
```

Load the data:
```{r}
df <- import("../data/cpu_passmark_market_share.json")
# head(df)
dim(df)
```

Upon inspecting the first several rows of the dataframe with `head(df)`, which I excluded from the output to make this document less cluttered, it looks like there are dataframes within `df`, specifically in the two columns for market share data.
```{r}
head(df$userbenchmark_market_share[1])
```

It appears that `import()` incorrectly placed market share information for every CPU by month in the columns instead of the other way around, so I'll need to manipulate the dataframe in some way to correctly organize the data.

## Data Preparation

I'll start by isolating the problematic columns along with the corresponding CPU names so that later I can align the CPUs with their market shares over time.
```{r}
cleaned <- df[, c("name", "userbenchmark_market_share", "passmark_market_share")]
```
```{r}
head(cleaned$userbenchmark_market_share)
```


Alright, so looks like my initial hypothesis was incorrect and I won't have to do too much manipulation. I think R was having trouble handling JSON nesting and that there's a limit to how much information it can show at a time.
```{r}
userbenchmark <- bind_cols(list(cleaned$name, cleaned$userbenchmark_market_share)) %>%
  rename(name = ...1) # workaround for weird naming issue
head(userbenchmark)
```

I'll repeat this for data scraped from PassMark.
```{r}
passmark <- bind_cols(list(cleaned$name, cleaned$passmark_market_share)) %>%
  rename(name = ...1)
head(passmark)
```

Even though it seems like the nesting structure was preserved in the original dataframe `df`, I still think it's a good idea to flatten the data like this for readability and simplicity. This will also make it easier to compare the two market share data sets I just created and fill in missing data when appropriate. For plotting purposes though, I'll probably need to reshape the combined dataframe.

However, before I just combine `userbenchmark` and `passmark`, I need to establish several criteria for comparing the two dataframes:
* 